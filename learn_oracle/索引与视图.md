# 索引与视图

## 1 索引（index）

作用：优化数据库查询的效率，提升数据库的查询性能。

`Oracle`中常见的索引类型：`B-Tree`，`BITMAP`，`函数索引`，`hash索引`，`reverse反向索引`，`分区索引和分区表的全局索引`

- 索引的创建

  ```plsql
  create [unique]|[bitmap] index index_name --UNIQUE表示唯一索引、BITMAP位图索引
  on table_name(column1,column2...|[express])  --express表示函数索引
  [tablespace tab_name] --tablespace表示索引存储的表空间
  [pctfree n1]     --索引块的空闲空间n1
  [storage         --存储块的空间
   (
      initial 64K  --初始64k
      next 1M
      minextents 1
      maxextents unlimited
  )];
  注释：
  column_name：指定要对哪个列创建索引，也可以对多列创建索引，这种索引称为组合索引。若为函数表达式，则称为函数索引。
  ```
  
- 修改(alter)索引

  ```plsql
  alter index index_old rename to index_new;  --重新命名索引
  alter index index_name coalesce;  --合并索引
  alter index index_name rebuild;  --重新构造
  ```

- 删除(drop)索引

  ```plsql
  drop index index_name;  --删除索引
  ```

- 查询索引状态

  ```plsql
  select t.INDEX_NAME,  --索引名字
         t.index_type,  --索引类型
         t.TABLESPACE_NAME,  --表空间
         t.status,  --状态
         t.UNIQUENESS  --是否唯一索引
    from all_indexes T 
    where  t.INDEX_NAME='index_name';		--index_name为索引名
  ```

## 2 视图（view）

`Oracle`视图可以理解为数据库中一张虚拟的表，它是通过一张或者多张基表进行关联查询后组成一个虚拟的逻辑表。查询视图，本质上是对表进行关联查询。                                                      视图本身是不包含任何数据，只是一个查询结果，当基表的数据发生变化时，视图里面的数据也会跟着发生变化。

**视图的分类**：单表视图，多表关联视图，视图中含有子视图。

- 创建视图

  ```plsql
  CREATE [OR REPLACE] VIEW view_name AS
  SELECT 查询条件
  [WITH READ ONLY CONSTRAINT]
  解释：
  1、OR REPLACE：如果视图已经存在，则替换旧视图。
  2、WITH READ ONLY：默认不填的，用户是可以通过视图对基表执行增删改操作，但是有很多在基表上的限制，WITH READ ONLY说明视图是只读视图，不能通过该视图进行增删改操作。但是在现实开发中，基本上不通过视图对表中的数据进行增删改操作。 
  ```

  ```plsql
  --案例：创建多表关联视图
  create view vw_stuinfo as 
  select a.stuid,--学号
         a.stuname,--学生姓名
         a.grade,--年级
         a.age,--年龄
         b.classname,--班级
         b.monitorname,--班长
         b.headmastername--班主任
    from stuinfo a, class b
   where a.classno = b.classno;
   --利用上面创建的视图查询
  select * from vw_stuinfo  --vw_stuinfo为视图名
  [where column = 'column1'];  --可以添加限制条件，视图还可以嵌套
  ```

- 删除视图

  ```plsql
  DROP VIEW view_name;
  ```

  